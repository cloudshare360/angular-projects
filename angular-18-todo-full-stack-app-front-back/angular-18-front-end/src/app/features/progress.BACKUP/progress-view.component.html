<div class="progress-container">
  <!-- Header -->
  <div class="progress-header">
    <button class="btn-back" (click)="goBack()">
      ← Back to Dashboard
    </button>
    <h1>📊 Progress Tracking</h1>
  </div>

  <!-- Overall Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card primary">
      <div class="stat-icon">✅</div>
      <div class="stat-details">
        <div class="stat-value">{{ completedTodos }}</div>
        <div class="stat-label">Completed Tasks</div>
      </div>
    </div>

    <div class="stat-card warning">
      <div class="stat-icon">⏳</div>
      <div class="stat-details">
        <div class="stat-value">{{ pendingTodos }}</div>
        <div class="stat-label">Pending Tasks</div>
      </div>
    </div>

    <div class="stat-card success">
      <div class="stat-icon">📈</div>
      <div class="stat-details">
        <div class="stat-value">{{ overallProgress }}%</div>
        <div class="stat-label">Overall Progress</div>
      </div>
    </div>

    <div class="stat-card fire">
      <div class="stat-icon">🔥</div>
      <div class="stat-details">
        <div class="stat-value">{{ currentStreak }}</div>
        <div class="stat-label">Day Streak</div>
      </div>
    </div>
  </div>

  <!-- Overall Progress Bar -->
  <div class="progress-section">
    <h2>Overall Completion</h2>
    <div class="progress-bar-container">
      <div class="progress-bar" [style.width.%]="overallProgress">
        <span class="progress-text">{{ overallProgress }}%</span>
      </div>
    </div>
    <p class="progress-info">{{ completedTodos }} of {{ totalTodos }} tasks completed</p>
  </div>

  <!-- Category Progress -->
  <div class="progress-section">
    <h2>Progress by Category</h2>
    <div class="category-progress-list">
      <div class="category-item" *ngFor="let category of categoryStats">
        <div class="category-header">
          <span class="category-name">{{ category.name }}</span>
          <span class="category-stats">{{ category.completed }}/{{ category.total }} ({{ category.percentage }}%)</span>
        </div>
        <div class="category-bar-container">
          <div class="category-bar" [style.width.%]="category.percentage" [style.background]="category.color"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Weekly Activity Chart -->
  <div class="progress-section">
    <h2>Weekly Activity</h2>
    <div class="chart-container">
      <div class="chart-legend">
        <div class="legend-item">
          <span class="legend-color completed"></span>
          <span>Completed</span>
        </div>
        <div class="legend-item">
          <span class="legend-color created"></span>
          <span>Created</span>
        </div>
      </div>
      <div class="bar-chart">
        <div class="chart-bars" *ngFor="let day of weeklyProgress">
          <div class="bar-group">
            <div
              class="bar completed"
              [style.height.%]="getBarHeight(day.completed, getMaxValue(weeklyProgress))"
              [title]="'Completed: ' + day.completed"
            >
              <span class="bar-value" *ngIf="day.completed > 0">{{ day.completed }}</span>
            </div>
            <div
              class="bar created"
              [style.height.%]="getBarHeight(day.created, getMaxValue(weeklyProgress))"
              [title]="'Created: ' + day.created"
            >
              <span class="bar-value" *ngIf="day.created > 0">{{ day.created }}</span>
            </div>
          </div>
          <div class="bar-label">{{ day.date }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Priority Distribution -->
  <div class="progress-section">
    <h2>Task Priority Distribution</h2>
    <div class="priority-grid">
      <div class="priority-card" *ngFor="let priority of priorityStats">
        <div class="priority-icon" [style.background]="priority.color">
          {{ priority.count }}
        </div>
        <div class="priority-name">{{ priority.name }} Priority</div>
      </div>
    </div>
  </div>

  <!-- Time Insights -->
  <div class="progress-section">
    <h2>⏰ Time Insights</h2>
    <div class="insights-grid">
      <div class="insight-card">
        <div class="insight-icon">⏱️</div>
        <div class="insight-label">Avg. Completion Time</div>
        <div class="insight-value">{{ averageCompletionTime }}</div>
      </div>
      <div class="insight-card">
        <div class="insight-icon">📅</div>
        <div class="insight-label">Most Productive Day</div>
        <div class="insight-value">{{ mostProductiveDay }}</div>
      </div>
      <div class="insight-card">
        <div class="insight-icon">🕐</div>
        <div class="insight-label">Best Time</div>
        <div class="insight-value">{{ mostProductiveTime }}</div>
      </div>
    </div>
  </div>

  <!-- Achievements -->
  <div class="progress-section">
    <h2>🏆 Achievements</h2>
    <div class="achievements-grid">
      <div
        class="achievement-card"
        *ngFor="let achievement of achievements"
        [class.unlocked]="achievement.unlocked"
        [class.locked]="!achievement.unlocked"
      >
        <div class="achievement-icon">{{ achievement.icon }}</div>
        <div class="achievement-title">{{ achievement.title }}</div>
        <div class="achievement-description">{{ achievement.description }}</div>
        <div class="achievement-status">
          {{ achievement.unlocked ? '✓ Unlocked' : '🔒 Locked' }}
        </div>
      </div>
    </div>
  </div>

  <!-- Streak Info -->
  <div class="progress-section">
    <h2>🔥 Streak Information</h2>
    <div class="streak-cards">
      <div class="streak-card current">
        <div class="streak-value">{{ currentStreak }}</div>
        <div class="streak-label">Current Streak</div>
        <div class="streak-desc">Days in a row</div>
      </div>
      <div class="streak-card best">
        <div class="streak-value">{{ longestStreak }}</div>
        <div class="streak-label">Longest Streak</div>
        <div class="streak-desc">Personal best</div>
      </div>
    </div>
  </div>
</div>
